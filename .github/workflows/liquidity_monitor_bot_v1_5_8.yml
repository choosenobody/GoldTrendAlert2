name: Liquidity Monitor Bot v1.5.8

on:
  workflow_dispatch:
  schedule:
    # Mon/Wed/Fri 21:00 (UTC+8) = 13:00 UTC
    - cron: '0 13 * * 1,3,5'
    # Sunday 21:00 (UTC+8) = 13:00 UTC
    - cron: '0 13 * * 0'

jobs:
  run:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install deps
        run: |
          python -m pip install --upgrade pip
          pip install requests

      - name: Run bot (v1.5.8)
        env:
          SOSOVALUE_API_KEY: ${{ secrets.SOSOVALUE_API_KEY }}
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
          BTC_ETF_API_URL: ${{ vars.BTC_ETF_API_URL }}
          BTC_ETF_API_METHOD: ${{ vars.BTC_ETF_API_METHOD }}
          BTC_ETF_API_HEADERS: ${{ secrets.BTC_ETF_API_HEADERS }}
          BTC_ETF_API_BODY: ${{ vars.BTC_ETF_API_BODY }}
          BTC_ETF_FLOWS_CSV_URL: ${{ vars.BTC_ETF_FLOWS_CSV_URL }}
          ETF_LONG_D: ${{ vars.ETF_LONG_D }}
          ETF_SHORT_D: ${{ vars.ETF_SHORT_D }}
          FAIR_BAND_LOW: ${{ vars.FAIR_BAND_LOW }}
          FAIR_BAND_HIGH: ${{ vars.FAIR_BAND_HIGH }}
          PLAN_MAX_GOLD_WEIGHT: ${{ vars.PLAN_MAX_GOLD_WEIGHT }}
          TAKE_PROFIT_LEVELS: ${{ vars.TAKE_PROFIT_LEVELS }}
          BUY_TRIGGER: ${{ vars.BUY_TRIGGER }}
          BUY_BANDS: ${{ vars.BUY_BANDS }}
          UST_AUCTIONS_DELTA: ${{ vars.UST_AUCTIONS_DELTA }}
        run: |
          python liquidity_monitor_bot_v1_5_8.py
